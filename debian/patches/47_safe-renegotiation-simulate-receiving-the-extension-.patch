From f4673b987ac0f6a00f1c26a3bcef4520bcf7d8a3 Mon Sep 17 00:00:00 2001
From: Nikos Mavrogiannopoulos <nmav@gnutls.org>
Date: Fri, 31 Jul 2015 22:42:42 +0200
Subject: [PATCH 4/4] safe renegotiation: simulate receiving the extension on
 receival of SCSV

---
 lib/ext/safe_renegotiation.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/lib/ext/safe_renegotiation.c b/lib/ext/safe_renegotiation.c
index 1a58418..054a59e 100644
--- a/lib/ext/safe_renegotiation.c
+++ b/lib/ext/safe_renegotiation.c
@@ -219,6 +219,7 @@ int _gnutls_ext_sr_recv_cs(gnutls_session_t session)
 
 	priv->safe_renegotiation_received = 1;
 	priv->connection_using_safe_renegotiation = 1;
+	_gnutls_extension_list_add(session, GNUTLS_EXTENSION_SAFE_RENEGOTIATION);
 
 	if (set != 0)
 		_gnutls_ext_set_session_data(session,
-- 
2.4.6

